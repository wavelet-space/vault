################################################################################
# Igneous Processes: Homework 03; David Landa (Mixing)
################################################################################

# 21.2

# C_M = f_1 * C_1 + (1 - f_1) * C2
# (C_M - C2) = f_1 * (C1 - C2)

data <- "
  wt,    C1,    CM,    C2
  SiO2,  64.60, 59.58, 49.21
  TiO2,  0.57,  0.72,  1.02
  Al2O3, 14.99, 14.80, 13.69
  FeO,   2.79,  4.08,  6.96
  Fe2O3, 1.27,  1.69,  2.47
  MnO,   0.08,  0.14,  0.15
  MgO,   2.37,  4.11,  8.53
  CaO,   3.44,  5.33,  9.74
  Na2O,  3.12,  2.84,  1.89
  K2O,   4.34,  4.19,  3.61
"

M <- read.csv(text=data, sep=",", header=TRUE)

mix1 <- M$C1 - M$C2
print(mix1)

mix2 <- M$CM - M$C2
print(mix2)

f1 <- mix2 / mix1
print(f1)


C_M = f1 * M$C1 + (1 - f1) * M$C2

# ##############################################################################
# Linear regression and plot
# ##############################################################################

lm_ <- lm(mix2 ~ mix1)
summary(lm_)

plot(mix1, mix2, ylab="C_M - C2", xlab="C1 - C2", pch=3)
abline(lm_, col="red")

# ##############################################################################
# granodiorite: 68,41	%
# ##############################################################################
